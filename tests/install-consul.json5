{
  vars: {
    consulVersion: "1.2.3",
    consulZipFile: "{{HOME}}/downloads/consul_1.2.3_linux_amd64.zip",
    consulUnzipDir: "{{HOME}}/downloads/consul_1.2.3",
  },
  assertions: [
    {
      assert: "DirectoryExists",
      with: {
        path: "{{HOME}}/downloads",
      },
    },
    {
      assert: "FileDownloaded",
      with: {
        url: "https://releases.hashicorp.com/consul/${consulVersion}/consul_${consulVersion}_linux_amd64.zip",
        checksum: "658f4f3b305cd357a9501728b8a1dc5f",
        checksumType: "etag",
        toFile: "${consulZipFile}",
      },
    },
    {
      assert: "FileUnzipped",
      with: {
        zipFile: "${consulZipFile}",
        toDir: "${consulUnzipDir}",
        expectFile: "consul"
      },
    },
    {
      assert: "fileCopied",
      with: {
        fromFile: "${consulUnzipDir}/consul",
        toDir: "/usr/local/bin",
      },
    },
    {
      assert: "commandOutputs",
      with: {
        command: "consul --version",
        regex: "^Consul\\sv${consuleVersion}$",
        occurance: 1,
      },
    },
  ],
}
